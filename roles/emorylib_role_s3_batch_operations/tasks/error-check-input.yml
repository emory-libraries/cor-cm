---

- name: Test out slack functionality
  slack:
    attachments: '{{ s3_batch_op_slack_attachments | d (omit) }}'
    token: '{{ s3_batch_op_slack_token }}'
    msg: '{{ s3_batch_op_slack_msg | d (omit) }}'
    channel: '{{ s3_batch_op_slack_channel }}'
    thread_id: '{{ s3_batch_op_slack_thread_id | d (omit) }}'
    username: '{{ s3_batch_op_slack_username | d (omit) }}'
    icon_url: '{{ s3_batch_op_slack_icon_url | d (omit) }}'
    icon_emoji: '{{ s3_batch_op_slack_icon_emoji | d (omit) }}'
    link_names: '{{ s3_batch_op_slack_link_names | d (omit) }}'
    parse: '{{ s3_batch_op_slack_parse | d (omit) }}'
  vars:
    optional_variable: none
    required_variable: Required Variable is Required

- pause: 

- name: Assert that location and Location are exclusive (1st)
  assert:
    that:
      - s3_batch_op.manifest.Location is undefined
    fail_msg: 'location and manifest.Location are exclusive options, please remove one'
    quiet: yes
  when: s3_batch_op.location is defined

- name: Assert that location and Location are exclusive (2nd)
  assert:
    that:
      - s3_batch_op.location is undefined
    fail_msg: 'location and manifest.Location are exclusive options, please remove one'
    quiet: yes
  when: s3_batch_op.manifest.Location is defined

- name: Assert that submit only is false when requesting report links
  assert:
    that: not s3_batch_op_submit_only
    fail_msg: Requesting report links requires that s3_batch_op_submit_only be set to false. Please change and restart.
    quiet: yes
  when: s3_batch_op_generate_direct_download or s3_batch_op_generate_console_download