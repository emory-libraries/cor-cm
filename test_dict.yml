- hosts: localhost
  vars_files: test_dict_var.yml

  tasks:
    - set_fact:
        project_name: "{{ url | urlsplit('path') | basename }}"

    - name: Replace non-alphanumeric characters in {{ project_name }} with underscores
      set_fact:
       _project_name: "{{ project_name | regex_replace('[^0-9a-zA-Z]+', '_') }}"

    - debug:
        msg: "{{ url | urlsplit('path') | basename }}"

#    - lineinfile:
#        path: "{{ playbook_dir }}/file.conf"
#        insertafter: '/Shibboleth.sso'
#        line: "  PassengerEnabled off"
#        backup: yes

#    - name:
#      shell: httpd -M
#      register: apache_modules_content

#    - debug:
#        var: apache_modules_content.stdout.find('authn_socache_module')

#    - debug:
#        msg: "{{ test_path.path | basename }}"

#    - debug:
#        msg: "{{ project_name | regex_replace('[^0-9a-zA-Z]+', '_') }}"

#    - set_fact:
#        __idp_meta: "{{ meta_end | selectattr('name', 'eq', meta_name) | list }}"
#    - set_fact:
#        idp_meta: "{{ idp_meta|default({}) | combine( {'url': item.url}, {'name': item.name}, {'id': item.id}  ) }}"
#      loop: "{{ meta_end | selectattr('name', 'eq', meta_name) | list }}"

#    - name: Test filters
#      debug:
#        msg: "{{ meta_end | selectattr('name', 'eq', meta_name) | list }}"
#    - name:
#      debug:
#        msg: "{{ idp_meta }}"
